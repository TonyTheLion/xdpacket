# test_mirror.yaml
# incoming packets have their MAC and IP src/dest addresses swapped,
# then reflected out the same interface
---
xdpk:
  - iface: enp0s3
  - field: any
    offt: 0
    len: 0
  - field: mac dst
    offt: 0
    len: 6
  - field: mac src
    offt: 6
    len: 6
  - field: ip src
    offt: 26
    len: 4
  - field: ip dst
    offt: 30
    len: 4
  - rule: reflect
    match:
      - any:
    write:
      - mac dst: mac src
      - mac src: mac dst
      - ip src: ip dst
      - ip dst: ip src
  - process: enp0s3
    rules:
      - reflect: enp0s3
...
